@extends('layouts.base')

@section('title', 'Mapa testeo')
@section('username', 'David')
@section('stylesheet')
{{--	<link href="{{asset('css/forms.css')}}" rel="stylesheet"/>--}}
{{--	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">--}}

	<!-- Leaflet CSS -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
	      integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
	      crossorigin=""/>
@endsection


@section('content')
	<h2>Mapa de incidentes</h2>

	<div id="mapid" style="height: 700px"></div>

@endsection

@section('scripts')
	<!-- Latest compiled and minified JavaScript -->
{{--	<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>--}}

	<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
	        integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
	        crossorigin=""></script>

{{--	<script src="{{asset('js/incidents/map-incidents.js')}}"></script>--}}
	<script>
        const mymap = L.map('mapid');
        mymap.setView([37.18,-3.6], 14);
        const incidentsLayerGroup = L.layerGroup().addTo(mymap);

        const arrIncidents = [[37.19016109967174, -3.6243071643477176],
            [37.19389391961641, -3.6212835141490896],
            [37.189784957735014, -3.6327788025945784],
            [37.189360389661665, -3.630419139057779],
            [37.19229188706235, -3.6240524066318294],
            [37.18853134581088, -3.6280407385594717],
            [37.19318935840569, -3.629105435402297],
            [37.192795828555184, -3.6318520332217745],
            [37.18974513608138, -3.6223242234271327],
            [37.19018216071378, -3.623924233650844],
            [37.192746861309935, -3.6259065804906063],
            [37.189666838490155, -3.626967526633219],
            [37.19429716585017, -3.6262467803513037],
            [37.19266598220155, -3.6216677591866566],
            [37.19148884578229, -3.6241057838225466],
            [37.18847537457633, -3.627002174078687],
            [37.18880860270944, -3.6205549057968542],
            [37.190430944929666, -3.6314789667404512],
            [37.19189229242537, -3.632613652308773],
            [37.18846749909218, -3.6313187729335623],
            [37.19086241546933, -3.6315084906516732],
            [37.18894238616205, -3.623488844042092],
            [37.191821038462486, -3.632169681891382],
            [37.193549580357015, -3.6282336321255984],
            [37.19200708708738, -3.623364619365049],
            [37.189026347640954, -3.632746465332944],
            [37.18977436369414, -3.63194442389471],
            [37.189411866896265, -3.6321991308596178],
            [37.19230559097993, -3.622407674127878],
            [37.19031495887334, -3.6302618134428113],
            [37.207013901045144, -3.606124659364493],
            [37.20856322223922, -3.604999082897774],
            [37.20981173973216, -3.6134756767816993],
            [37.20601520267167, -3.5979070437494234],
            [37.20739459143867, -3.598447412488734],
            [37.20970184536574, -3.6157715978906153],
            [37.20732747356743, -3.6140248609541312],
            [37.20074811459221, -3.6096290293377646],
            [37.201958344510786, -3.606811227437336],
            [37.20226137032011, -3.6084820387438894],
            [37.204604326413865, -3.5997143385648815],
            [37.208577907620594, -3.6019422747253493],
            [37.20568538434649, -3.614832168364829],
            [37.20785504425199, -3.613541392186036],
            [37.20940450213953, -3.6127317099752503],
            [37.203236220929114, -3.605949553214021],
            [37.20324664039889, -3.6120446784884486],
            [37.20896787944957, -3.6038207952429837],
            [37.20415751860557, -3.6170259566104304],
            [37.20683972523008, -3.608377946523378],
            [37.20480776249421, -3.6091316082604084],
            [37.205816113230654, -3.6005292525426196],
            [37.2089325954809, -3.5989548180707778],
            [37.209091073241154, -3.61586097792516],
            [37.207479205190104, -3.616970455915976],
            [37.206033602104974, -3.6155017374142413],
            [37.20829841813843, -3.6053967124902577],
            [37.20897415843201, -3.609698930816147],
            [37.20490862175454, -3.6086863358428096],
            [37.20488800153779, -3.6127210962798597],
            [37.16025059952082, -3.590938716519334],
            [37.15602719117272, -3.6042744532744138],
            [37.14689683577468, -3.593502213677107],
            [37.1542639995787, -3.602313685736745],
            [37.15482204332451, -3.607607191022953],
            [37.15247269188641, -3.597382389911368],
            [37.148615130387455, -3.591395100223499],
            [37.15773729446485, -3.5937211546240895],
            [37.15049073996094, -3.59227909177136],
            [37.151602755213524, -3.5938734696675856],
            [37.15434936198799, -3.6015501261640264],
            [37.15863516191339, -3.59175062493771],
            [37.151413570234006, -3.606286361328138],
            [37.147757080157106, -3.595420348066739],
            [37.15705670036946, -3.6023764600739416],
            [37.16172882235016, -3.5931565457547805],
            [37.149768293157095, -3.601304607687883],
            [37.15944497936896, -3.598679321342428],
            [37.14898811466517, -3.5940256518412474],
            [37.14692087570571, -3.598327028949575],
            [37.16107482491925, -3.5908321168790485],
            [37.14776446525226, -3.5909267281110453],
            [37.15568151225255, -3.591766852585125],
            [37.15729906000303, -3.600262198920976],
            [37.16364552319663, -3.5909824824500607],
            [37.16338845069291, -3.607609876695696],
            [37.15561286032254, -3.606070771650051],
            [37.16066145223502, -3.5987033938578588],
            [37.15042388307875, -3.606738263597774],
            [37.15852667153379, -3.593352044195148],
            [37.17771490694243, -3.5920460496929016],
            [37.186509941991304, -3.5963972431754994],
            [37.18034320703471, -3.590223102775011],
            [37.18461423431019, -3.5922137919426937],
            [37.17843080376549, -3.5956438197738168],
            [37.177280201564294, -3.5966926384873283],
            [37.17956824117453, -3.5947449186826947],
            [37.182790948443845, -3.589505080619002],
            [37.18641182549476, -3.5977647894011318],
            [37.18035918857775, -3.589130885943556],
            [37.17872780889588, -3.5926374157564505],
            [37.18300453818564, -3.597146694210991],
            [37.18733635863805, -3.591665130112215],
            [37.184019286649225, -3.5946016052721084],
            [37.18308864154494, -3.5896945941032845],
            [37.18286945168588, -3.5941215072129125],
            [37.17861223603312, -3.593899436817789],
            [37.182397490647624, -3.5912259870418275],
            [37.177542934200055, -3.5990425400315598],
            [37.17958560922875, -3.5891277722797357],
            [37.18336637950322, -3.599086090069649],
            [37.18591656877934, -3.5901161280765743],
            [37.18770564825976, -3.5929656456142074],
            [37.18432132755845, -3.5957520252554684],
            [37.18974396303001, -3.591408707356248],
            [37.18853251070685, -3.5925711216805865],
            [37.183910838782786, -3.594616997596702],
            [37.18234832587454, -3.5922045128159605],
            [37.18583641981858, -3.597863301227371],
            [37.184509664540016, -3.59732973063825]];
        const centers = [[37.190896404210136, -3.6274758456372975],
            [37.18291331672874, -3.5937146421221176],
            [37.15470640548111, -3.5957238722889238],
            [37.20630249040072, -3.6109004262065807]];

        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors, ' +
                '<a href="https://creativecommons.org/licenses/by-sa/2.0/" target="_blank">CC-BY-SA</a>, ' +
                'Imagery Â© <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',
            maxZoom: 22,
            id: 'mapbox/streets-v11',
            accessToken: 'pk.eyJ1IjoiZGF2aWRjaGljaGFycm8iLCJhIjoiY2s4dTRuenNqMDE5djNka2Q0amE3bHBnYyJ9.ebGkyWx_FQLj5oBW936UJg'
        }).addTo(mymap);

        arrIncidents.forEach(value =>  {
            L.marker([value[0], value[1]]).addTo(incidentsLayerGroup);
        });

        const redIcon = new L.Icon({
            iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });
        centers.forEach(value =>  {
            L.marker([value[0], value[1]], {icon: redIcon}).addTo(incidentsLayerGroup);
        });
        /*$.each(result, function(index, value){
            L.marker([value.latitud, value.longitud])
                .bindPopup('<b>'+value.incidente+'</b>  -  '+
                    value.fecha_hora+'.<br>'+value.nombre_lugar
                    +'<br>'+value.descripcion)
                .addTo(incidentsLayerGroup);
        });*/
	</script>
@endsection
